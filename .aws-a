
# Convenient aliases for the aws cli
# NB: These aliases uses jq (https://stedolan.github.io/jq/) judiciously!

alias awho='aws sts get-caller-identity'

# usage: eps 
eps() {
    aws "$@" --output json ec2 describe-instances | jq -r '.Reservations[].Instances[]| .InstanceId + " " + .InstanceType + " " + .State.Name + " " + .PublicIpAddress + " " + .Tags[0].Value'
}

# usage: ekill <instance-id>
ekill() {
    aws  --output json ec2 terminate-instances --instance-id "$@"
}

# usage: epurge
# terminate all running instances
epurge() {
    ekill `eps | grep running | awk '{print $1}'`
}

alias s3ls='aws s3 ls '
alias s3lsr='aws s3 ls --recursive'
alias s3cp='aws s3 cp '
alias s3rm='aws s3 rm '
alias s3mv='aws s3 mv '


# NB: You must fill in .ec2.mak with *at least* the security group and subnet; review the others.

alias erun='make -f ~/.ec2.mak up'
alias essh='make -f ~/.ec2.mak ssh'

alias earm='make -f ~/.ec2.mak arm'
alias essh2='make -f ~/.ec2.mak ssh-arm'
